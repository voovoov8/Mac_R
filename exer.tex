% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother

\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={exer},
  pdfauthor={yoon},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{exer}
\author{yoon}
\date{}

\begin{document}
\maketitle


\section{기말 연습용}\label{uxae30uxb9d0-uxc5f0uxc2b5uxc6a9}

\subsection{1. 선형을 활용한
예측}\label{uxc120uxd615uxc744-uxd65cuxc6a9uxd55c-uxc608uxce21}

\subsubsection{1-1. loading}\label{loading}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(caret)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Loading required package: ggplot2
\end{verbatim}

\begin{verbatim}
Loading required package: lattice
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(MASS)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
-- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
v dplyr     1.1.4     v readr     2.1.4
v forcats   1.0.0     v stringr   1.5.1
v lubridate 1.9.3     v tibble    3.2.1
v purrr     1.0.2     v tidyr     1.3.0
\end{verbatim}

\begin{verbatim}
-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()
x purrr::lift()   masks caret::lift()
x dplyr::select() masks MASS::select()
i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gpa }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"dataforclass/gpa1.csv"}\NormalTok{,}\AttributeTok{header =} \ConstantTok{TRUE}\NormalTok{,}
                \AttributeTok{sep =} \StringTok{"}\SpecialCharTok{\textbackslash{}t}\StringTok{"}\NormalTok{)}
\FunctionTok{str}\NormalTok{(gpa)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   141 obs. of  29 variables:
 $ age     : int  21 21 20 19 20 20 22 22 22 19 ...
 $ soph    : int  0 0 0 1 0 0 0 0 0 1 ...
 $ junior  : int  0 0 1 0 1 0 0 0 0 0 ...
 $ senior  : int  1 1 0 0 0 1 0 0 0 0 ...
 $ senior5 : int  0 0 0 0 0 0 1 1 1 0 ...
 $ male    : int  0 0 0 1 0 1 0 0 0 0 ...
 $ campus  : int  0 0 0 1 0 1 0 0 0 0 ...
 $ business: int  1 1 1 1 1 1 1 0 0 1 ...
 $ engineer: int  0 0 0 0 0 0 0 0 0 0 ...
 $ colGPA  : num  3 3.4 3 3.5 3.6 ...
 $ hsGPA   : num  3 3.2 3.6 3.5 3.9 ...
 $ ACT     : int  21 24 26 27 28 25 25 22 21 27 ...
 $ job19   : int  0 0 1 1 0 0 0 1 1 1 ...
 $ job20   : int  1 1 0 0 1 0 0 0 0 0 ...
 $ drive   : int  1 1 0 0 0 0 0 1 1 0 ...
 $ bike    : int  0 0 0 0 1 0 1 0 0 0 ...
 $ walk    : int  0 0 1 1 0 1 0 0 0 1 ...
 $ voluntr : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PC      : int  0 0 0 0 0 0 0 1 0 1 ...
 $ greek   : int  0 0 0 0 0 0 1 0 0 0 ...
 $ car     : int  1 1 1 0 1 1 1 0 1 0 ...
 $ siblings: int  1 0 1 1 1 1 1 1 1 1 ...
 $ bgfriend: int  0 1 0 0 1 0 0 1 1 0 ...
 $ clubs   : int  0 1 1 0 0 0 1 0 1 1 ...
 $ skipped : num  2 0 0 0 0 0 0 3 2 0.5 ...
 $ alcohol : num  1 1 1 0 1.5 0 2 3 2.5 0.75 ...
 $ gradMI  : int  1 1 1 0 1 0 1 1 1 1 ...
 $ fathcoll: int  0 1 1 0 1 1 0 1 1 0 ...
 $ mothcoll: int  0 1 1 0 0 0 1 1 1 1 ...
\end{verbatim}

\subsubsection{1-2. train과 test 데이터
구분}\label{trainuxacfc-test-uxb370uxc774uxd130-uxad6cuxbd84}

\begin{itemize}
\tightlist
\item
  데이터 구분
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{train\_i }\OtherTok{\textless{}{-}} \FunctionTok{createDataPartition}\NormalTok{(gpa}\SpecialCharTok{$}\NormalTok{colGPA,}
                               \AttributeTok{p =} \FloatTok{0.8}\NormalTok{,}
                               \AttributeTok{list =} \ConstantTok{FALSE}\NormalTok{) }
\NormalTok{train }\OtherTok{\textless{}{-}}\NormalTok{ gpa[train\_i,]}
\NormalTok{test }\OtherTok{\textless{}{-}}\NormalTok{ gpa[}\SpecialCharTok{{-}}\NormalTok{train\_i,]}
\FunctionTok{str}\NormalTok{(train)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   115 obs. of  29 variables:
 $ age     : int  20 19 20 20 22 22 19 21 22 21 ...
 $ soph    : int  0 1 0 0 0 0 1 0 0 0 ...
 $ junior  : int  1 0 1 0 0 0 0 0 0 0 ...
 $ senior  : int  0 0 0 1 0 0 0 1 0 1 ...
 $ senior5 : int  0 0 0 0 1 1 0 0 1 0 ...
 $ male    : int  0 1 0 1 0 0 0 1 0 0 ...
 $ campus  : int  0 1 0 1 0 0 0 0 1 1 ...
 $ business: int  1 1 1 1 1 0 1 1 1 1 ...
 $ engineer: int  0 0 0 0 0 0 0 0 0 0 ...
 $ colGPA  : num  3 3.5 3.6 3 2.7 ...
 $ hsGPA   : num  3.6 3.5 3.9 3.4 3.5 ...
 $ ACT     : int  26 27 28 25 25 21 27 19 22 23 ...
 $ job19   : int  1 1 0 0 0 1 1 1 0 1 ...
 $ job20   : int  0 0 1 0 0 0 0 0 1 0 ...
 $ drive   : int  0 0 0 0 0 1 0 0 0 0 ...
 $ bike    : int  0 0 1 0 1 0 0 0 0 0 ...
 $ walk    : int  1 1 0 1 0 0 1 1 1 1 ...
 $ voluntr : int  0 0 0 0 0 0 0 0 1 0 ...
 $ PC      : int  0 0 0 0 0 0 1 0 0 1 ...
 $ greek   : int  0 0 0 0 1 0 0 0 0 0 ...
 $ car     : int  1 0 1 1 1 1 0 1 1 1 ...
 $ siblings: int  1 1 1 1 1 1 1 1 1 1 ...
 $ bgfriend: int  0 0 1 0 0 1 0 1 1 1 ...
 $ clubs   : int  1 0 0 0 1 1 1 0 1 1 ...
 $ skipped : num  0 0 0 0 0 2 0.5 2 1 0 ...
 $ alcohol : num  1 0 1.5 0 2 2.5 0.75 1 1 1 ...
 $ gradMI  : int  1 0 1 0 1 1 1 1 1 1 ...
 $ fathcoll: int  1 0 1 1 0 1 0 0 0 0 ...
 $ mothcoll: int  1 0 0 0 1 1 1 0 1 1 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   26 obs. of  29 variables:
 $ age     : int  21 21 22 20 22 20 20 21 21 19 ...
 $ soph    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ junior  : int  0 0 0 1 0 1 1 0 0 1 ...
 $ senior  : int  1 1 0 0 1 0 0 1 1 0 ...
 $ senior5 : int  0 0 1 0 0 0 0 0 0 0 ...
 $ male    : int  0 0 0 1 1 0 1 0 1 0 ...
 $ campus  : int  0 0 0 1 0 0 0 0 0 0 ...
 $ business: int  1 1 0 1 1 1 1 1 1 1 ...
 $ engineer: int  0 0 0 0 0 0 0 0 0 0 ...
 $ colGPA  : num  3 3.4 2.7 2.9 2.5 ...
 $ hsGPA   : num  3 3.2 3 3.8 3 ...
 $ ACT     : int  21 24 22 29 23 27 24 23 26 21 ...
 $ job19   : int  0 0 1 0 0 1 1 1 0 1 ...
 $ job20   : int  1 1 0 0 0 0 0 0 1 0 ...
 $ drive   : int  1 1 1 0 1 0 0 0 0 0 ...
 $ bike    : int  0 0 0 0 0 1 1 1 0 0 ...
 $ walk    : int  0 0 0 1 0 0 0 0 1 1 ...
 $ voluntr : int  0 0 0 0 0 0 0 0 0 1 ...
 $ PC      : int  0 0 1 0 0 1 0 1 1 0 ...
 $ greek   : int  0 0 0 0 0 1 1 1 1 0 ...
 $ car     : int  1 1 0 0 1 0 1 0 1 1 ...
 $ siblings: int  1 0 1 1 1 1 1 1 1 1 ...
 $ bgfriend: int  0 1 1 0 0 1 0 0 1 0 ...
 $ clubs   : int  0 1 0 0 1 0 1 1 0 1 ...
 $ skipped : num  2 0 3 3 5 2 1 0 1 0 ...
 $ alcohol : num  1 1 3 2.5 5 1 3 2 1 2 ...
 $ gradMI  : int  1 1 1 0 0 1 1 1 0 1 ...
 $ fathcoll: int  0 1 1 1 1 0 1 0 0 1 ...
 $ mothcoll: int  0 1 1 1 0 0 0 1 0 1 ...
\end{verbatim}

\subsubsection{1-3. 선형모형 제작과 예측
실험}\label{uxc120uxd615uxbaa8uxd615-uxc81cuxc791uxacfc-uxc608uxce21-uxc2e4uxd5d8}

\begin{itemize}
\tightlist
\item
  선형 모델 제작
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lm\_gpa }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(colGPA}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data =}\NormalTok{ train)}
\FunctionTok{summary}\NormalTok{(lm\_gpa)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Call:
lm(formula = colGPA ~ ., data = train)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.65279 -0.21952  0.00814  0.21419  0.61336 

Coefficients: (2 not defined because of singularities)
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.326361   1.017127   0.321 0.749073    
age          0.042697   0.037832   1.129 0.262141    
soph         0.332675   0.274478   1.212 0.228746    
junior       0.020796   0.139216   0.149 0.881597    
senior      -0.015759   0.116914  -0.135 0.893083    
senior5            NA         NA      NA       NA    
male         0.099869   0.082060   1.217 0.226846    
campus      -0.090739   0.102708  -0.883 0.379394    
business     0.080565   0.094846   0.849 0.397948    
engineer    -0.096085   0.214660  -0.448 0.655530    
hsGPA        0.504234   0.125697   4.011 0.000126 ***
ACT          0.001077   0.013416   0.080 0.936205    
job19       -0.015740   0.080700  -0.195 0.845810    
job20       -0.115783   0.104073  -1.113 0.268947    
drive        0.001758   0.107195   0.016 0.986952    
bike        -0.049754   0.083179  -0.598 0.551270    
walk               NA         NA      NA       NA    
voluntr     -0.018787   0.096905  -0.194 0.846726    
PC           0.143342   0.074843   1.915 0.058709 .  
greek        0.048514   0.078409   0.619 0.537693    
car         -0.081562   0.084742  -0.962 0.338448    
siblings    -0.142651   0.147284  -0.969 0.335427    
bgfriend     0.134528   0.070273   1.914 0.058824 .  
clubs        0.055595   0.073216   0.759 0.449685    
skipped     -0.108928   0.039751  -2.740 0.007433 ** 
alcohol      0.022333   0.030196   0.740 0.461506    
gradMI       0.149546   0.114017   1.312 0.193062    
fathcoll     0.040230   0.073516   0.547 0.585601    
mothcoll    -0.039230   0.079080  -0.496 0.621079    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3326 on 88 degrees of freedom
Multiple R-squared:  0.3982,    Adjusted R-squared:  0.2204 
F-statistic: 2.239 on 26 and 88 DF,  p-value: 0.002831
\end{verbatim}

\begin{itemize}
\tightlist
\item
  예측값 계산
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predic\_gpa }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lm\_gpa,}\AttributeTok{newdata =}\NormalTok{ test)}

\NormalTok{result }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{actual =}\NormalTok{ test}\SpecialCharTok{$}\NormalTok{colGPA,}
  \AttributeTok{predict =}\NormalTok{ predic\_gpa}
\NormalTok{)}
\FunctionTok{head}\NormalTok{(result)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   actual  predict
1     3.0 2.438904
2     3.4 3.094612
8     2.7 2.814086
14    2.9 2.825509
18    2.5 2.408235
27    3.0 3.198240
\end{verbatim}

\begin{itemize}
\tightlist
\item
  예측값 시각화
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ actual, }\AttributeTok{y =}\NormalTok{ predict)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{intercept =} \DecValTok{0}\NormalTok{ , }\AttributeTok{slope =} \DecValTok{1}\NormalTok{, }\AttributeTok{color =} \StringTok{"red"}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{exer_files/figure-pdf/unnamed-chunk-6-1.pdf}}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{labs}\NormalTok{( }
    \AttributeTok{x =} \StringTok{"실제 GPA"}\NormalTok{, }\AttributeTok{y =} \StringTok{"예측 GPA"}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$x
[1] "실제 GPA"

$y
[1] "예측 GPA"

attr(,"class")
[1] "labels"
\end{verbatim}

\begin{itemize}
\tightlist
\item
  MSE 와 RMSE
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 계산}
\NormalTok{mse }\OtherTok{=} \FunctionTok{mean}\NormalTok{(result}\SpecialCharTok{$}\NormalTok{actual }\SpecialCharTok{{-}}\NormalTok{ result}\SpecialCharTok{$}\NormalTok{predict)}\SpecialCharTok{\^{}}\DecValTok{2}
\NormalTok{rmse }\OtherTok{=} \FunctionTok{sqrt}\NormalTok{(mse)}

\CommentTok{\# 값 확인 }
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"MSE = "}\NormalTok{, mse))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "MSE =  0.00233854148013942"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"RMSE = "}\NormalTok{, rmse))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "RMSE =  0.048358468546258"
\end{verbatim}

\subsubsection{1-4. 모델 선택}\label{uxbaa8uxb378-uxc120uxd0dd}

\begin{itemize}
\tightlist
\item
  AIC 방법을 활용한 모델 선택
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 모델 확인 }
\NormalTok{slected\_model }\OtherTok{\textless{}{-}}  \FunctionTok{stepAIC}\NormalTok{(}\FunctionTok{lm}\NormalTok{(colGPA }\SpecialCharTok{\textasciitilde{}}\NormalTok{.,}\AttributeTok{data =}\NormalTok{ train),}
                          \AttributeTok{direction =} \StringTok{"both"}\NormalTok{,}
                          \AttributeTok{trace =} \ConstantTok{FALSE}
\NormalTok{                          )}

\CommentTok{\# 선택된 모델 확인}
\NormalTok{model }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(}\FunctionTok{coef}\NormalTok{(slected\_model))[}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}
\FunctionTok{print}\NormalTok{(model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] "age"      "soph"     "male"     "business" "hsGPA"    "job20"   
 [7] "PC"       "bgfriend" "skipped"  "gradMI"  
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 모델 붙여넣기 }
\NormalTok{temp }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(model, }\AttributeTok{collapse =} \StringTok{" + "}\NormalTok{)}
\NormalTok{formula }\OtherTok{\textless{}{-}}\FunctionTok{as.formula}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"colGPA \textasciitilde{}"}\NormalTok{,temp))}

\NormalTok{lm\_selected }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(formula, }\AttributeTok{data =}\NormalTok{ train)}
\FunctionTok{summary}\NormalTok{(lm\_selected)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Call:
lm(formula = formula, data = train)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.72161 -0.23913  0.00441  0.22841  0.72748 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.01568    0.78667  -0.020  0.98414    
age          0.04548    0.02825   1.610  0.11039    
soph         0.27239    0.19791   1.376  0.17168    
male         0.09745    0.06382   1.527  0.12979    
business     0.11590    0.07916   1.464  0.14618    
hsGPA        0.53978    0.10180   5.303 6.46e-07 ***
job20       -0.13276    0.08204  -1.618  0.10864    
PC           0.15051    0.06447   2.335  0.02148 *  
bgfriend     0.12291    0.06291   1.954  0.05344 .  
skipped     -0.08477    0.03177  -2.668  0.00884 ** 
gradMI       0.14309    0.10080   1.420  0.15871    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3152 on 104 degrees of freedom
Multiple R-squared:  0.361, Adjusted R-squared:  0.2996 
F-statistic: 5.876 on 10 and 104 DF,  p-value: 5.5e-07
\end{verbatim}




\end{document}
